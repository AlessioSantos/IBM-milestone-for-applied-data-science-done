<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jupyter Notebook — generated with runcell</title>
    <meta name="description" content="Exported with runcell — convert .ipynb notebooks to HTML or PDF anytime at runcell.dev." />
    <meta name="generator" content="runcell" />
    <style>
        :root {
            --jp-code-font-family: 'SFMono-Regular', Menlo, Consolas, 'Liberation Mono', monospace;
            --jp-content-font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
            --jp-cell-prompt-width: 64px;
            --jp-input-prompt-color: #307fc1;
            --jp-output-prompt-color: #bf5b3d;
            --jp-cell-input-bg: #f7f7f7;
            --jp-layout-color0: #ffffff;
            --jp-layout-color1: #f7f7f7;
            --jp-border-color1: #e0e0e0;
            --jp-content-font-color0: #000000;
            --jp-content-font-color1: #333333;
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: var(--jp-content-font-family);
            font-size: 14px;
            line-height: 1.5;
            color: var(--jp-content-font-color0);
            background-color: var(--jp-layout-color0);
            margin: 0;
            padding: 0;
        }

        .notebook-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Cell structure */
        .cell {
            display: flex;
            flex-direction: row;
            margin-bottom: 12px;
            position: relative;
        }

        .cell-prompt {
            min-width: var(--jp-cell-prompt-width);
            width: var(--jp-cell-prompt-width);
            font-family: var(--jp-code-font-family);
            font-size: 12px;
            padding: 10px 8px 10px 0;
            text-align: right;
            flex-shrink: 0;
            user-select: none;
        }

        .cell-content {
            flex: 1;
            min-width: 0;
            overflow: hidden;
        }

        /* Input prompt styling - Jupyter blue */
        .input-prompt {
            color: var(--jp-input-prompt-color);
            font-weight: bold;
        }

        /* Output prompt styling - Jupyter red/orange */
        .output-prompt {
            color: var(--jp-output-prompt-color);
            font-weight: bold;
        }

        /* Code cell input area */
        .input-area {
            background-color: var(--jp-cell-input-bg);
            border: 1px solid var(--jp-border-color1);
            border-radius: 2px;
            padding: 8px 12px;
            overflow-x: auto;
        }

        .input-area pre {
            margin: 0;
            font-family: var(--jp-code-font-family);
            font-size: 13px;
            line-height: 1.4;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        /* Output area */
        .output-area {
            margin-top: 0;
        }

        .output-wrapper {
            display: flex;
            flex-direction: row;
            margin-top: 4px;
        }

        .output-content {
            flex: 1;
            min-width: 0;
            padding: 8px 0;
        }

        .output-content pre {
            margin: 0;
            font-family: var(--jp-code-font-family);
            font-size: 13px;
            line-height: 1.4;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        /* Stream output (stdout/stderr) */
        .output-stream {
            font-family: var(--jp-code-font-family);
            font-size: 13px;
            line-height: 1.4;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .output-stderr {
            background-color: #fdd;
            padding: 8px 12px;
            border-radius: 2px;
        }

        /* Execute result / display data */
        .output-result {
            padding: 4px 0;
        }

        .output-result pre {
            margin: 0;
            font-family: var(--jp-code-font-family);
            font-size: 13px;
        }

        /* Image output */
        .output-image {
            max-width: 100%;
            height: auto;
            display: block;
        }

        /* HTML output (DataFrames, etc.) */
        .output-html {
            overflow-x: auto;
        }

        .output-html table {
            border-collapse: collapse;
            font-size: 13px;
            font-family: var(--jp-content-font-family);
        }

        .output-html table th,
        .output-html table td {
            border: 1px solid #ddd;
            padding: 6px 10px;
            text-align: left;
        }

        .output-html table th {
            background-color: #f5f5f5;
            font-weight: 600;
        }

        .output-html table tr:nth-child(even) {
            background-color: #fafafa;
        }

        /* Error output */
        .output-error {
            background-color: #fff0f0;
            padding: 8px 12px;
            border-radius: 2px;
            font-family: var(--jp-code-font-family);
            font-size: 13px;
            white-space: pre-wrap;
        }

        /* Markdown cell styling */
        .markdown-cell {
            padding: 10px 0;
        }

        .markdown-cell h1 {
            font-size: 2em;
            font-weight: 600;
            margin: 0.67em 0;
            padding-bottom: 0.3em;
            border-bottom: 1px solid var(--jp-border-color1);
        }

        .markdown-cell h2 {
            font-size: 1.5em;
            font-weight: 600;
            margin: 0.83em 0;
            padding-bottom: 0.3em;
            border-bottom: 1px solid var(--jp-border-color1);
        }

        .markdown-cell h3 {
            font-size: 1.25em;
            font-weight: 600;
            margin: 1em 0;
        }

        .markdown-cell h4 {
            font-size: 1em;
            font-weight: 600;
            margin: 1.33em 0;
        }

        .markdown-cell h5 {
            font-size: 0.875em;
            font-weight: 600;
            margin: 1.67em 0;
        }

        .markdown-cell h6 {
            font-size: 0.85em;
            font-weight: 600;
            margin: 2.33em 0;
            color: #6a737d;
        }

        .markdown-cell p {
            margin: 0 0 16px 0;
            line-height: 1.6;
        }

        .markdown-cell code {
            font-family: var(--jp-code-font-family);
            font-size: 85%;
            background-color: rgba(27, 31, 35, 0.05);
            padding: 0.2em 0.4em;
            border-radius: 3px;
        }

        .markdown-cell pre {
            background-color: var(--jp-cell-input-bg);
            border: 1px solid var(--jp-border-color1);
            border-radius: 3px;
            padding: 16px;
            overflow-x: auto;
            font-size: 85%;
            line-height: 1.45;
        }

        .markdown-cell pre code {
            background-color: transparent;
            padding: 0;
            border-radius: 0;
            font-size: 100%;
        }

        .markdown-cell blockquote {
            margin: 0 0 16px 0;
            padding: 0 1em;
            color: #6a737d;
            border-left: 4px solid #dfe2e5;
        }

        .markdown-cell ul,
        .markdown-cell ol {
            margin: 0 0 16px 0;
            padding-left: 2em;
        }

        .markdown-cell li {
            margin: 0.25em 0;
        }

        .markdown-cell a {
            color: #0366d6;
            text-decoration: none;
        }

        .markdown-cell a:hover {
            text-decoration: underline;
        }

        .markdown-cell hr {
            border: 0;
            border-top: 1px solid var(--jp-border-color1);
            margin: 24px 0;
        }

        .markdown-cell img {
            max-width: 100%;
            height: auto;
        }

        .markdown-cell table {
            border-collapse: collapse;
            margin: 0 0 16px 0;
        }

        .markdown-cell table th,
        .markdown-cell table td {
            border: 1px solid #dfe2e5;
            padding: 6px 13px;
        }

        .markdown-cell table th {
            font-weight: 600;
            background-color: #f6f8fa;
        }

        .markdown-cell table tr:nth-child(2n) {
            background-color: #f6f8fa;
        }

        /* Raw cell styling */
        .raw-cell {
            background-color: var(--jp-layout-color1);
            border: 1px solid var(--jp-border-color1);
            border-radius: 2px;
            padding: 8px 12px;
            font-family: var(--jp-code-font-family);
            font-size: 13px;
            white-space: pre-wrap;
        }

        /* Empty prompt placeholder */
        .prompt-empty {
            color: transparent;
        }

        .export-footer {
            margin-top: 32px;
            padding-top: 16px;
            border-top: 1px solid var(--jp-border-color1);
            color: #555;
            font-size: 13px;
            text-align: center;
        }

        .export-footer a {
            color: #0366d6;
            text-decoration: none;
        }

        .export-footer a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="notebook-container">
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><p style="text-align:center"><br>    <a href="https://skills.network" target="_blank"><br>    <img src="https://cf-courses-data.s3.us.cloud-object-storage.appdomain.cloud/assets/logos/SN_web_lightmode.png" width="200" alt="Skills Network Logo"><br>    </a><br></p><br><br><h1 align=center><font size = 5>Assignment: SQL Notebook for Peer Assignment</font></h1><br><br>Estimated time needed: <strong>60</strong> minutes.<br><br><h2>Introduction</h2><br>Using this Python notebook you will:<br><br>1.  Understand the Spacex DataSet<br>2.  Load the dataset  into the corresponding table in a Db2 database<br>3.  Execute SQL queries to answer assignment questions <br></div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h2>Overview of the DataSet</h2><br><br>SpaceX has gained worldwide attention for a series of historic milestones. <br><br>It is the only private company ever to return a spacecraft from low-earth orbit, which it first accomplished in December 2010.<br>SpaceX advertises Falcon 9 rocket launches on its website with a cost of 62 million dollars wheras other providers cost upward of 165 million dollars each, much of the savings is because Space X can reuse the first stage. <br><br><br>Therefore if we can determine if the first stage will land, we can determine the cost of a launch. <br><br>This information can be used if an alternate company wants to bid against SpaceX for a rocket launch.<br><br>This dataset includes a record for each payload carried during a SpaceX mission into outer space.<br></div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Download the datasets</h3><br><br>This assignment requires you to load the spacex dataset.<br><br>In many cases the dataset to be analyzed is available as a .CSV (comma separated values) file, perhaps on the internet. Click on the link below to download and save the dataset (.CSV file):<br><br> <a href="https://cf-courses-data.s3.us.cloud-object-storage.appdomain.cloud/IBM-DS0321EN-SkillsNetwork/labs/module_2/data/Spacex.csv" target="_blank">Spacex DataSet</a><br><br></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre># Install in your environment: sqlalchemy==1.3.9, ipython-sql, prettytable, -q pandas</pre></div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Connect to the database</h3><br><br>Let us first load the SQL extension and establish a connection with the database<br></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [3]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>%load_ext sql</pre></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [4]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>import csv, sqlite3
import prettytable
prettytable.DEFAULT = 'DEFAULT'

con = sqlite3.connect("my_data1.db")
cur = con.cursor()</pre></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [5]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>%sql sqlite:///my_data1.db</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream">MetaData.__init__() got an unexpected keyword argument 'bind'
Connection info needed in SQLAlchemy format, example:
               postgresql://username:password@hostname/dbname
               or an existing connection: dict_keys([])
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [6]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>import pandas as pd
df = pd.read_csv("https://cf-courses-data.s3.us.cloud-object-storage.appdomain.cloud/IBM-DS0321EN-SkillsNetwork/labs/module_2/data/Spacex.csv")
df.to_sql("SPACEXTBL", con, if_exists='replace', index=False,method="multi")</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt">Out[6]:</div>
                        <div class="output-content">
                            <div class="output-result"><pre>101</pre></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><strong>Note:This below code is added to remove blank rows from table</strong><br></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [7]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>#DROP THE TABLE IF EXISTS

%sql DROP TABLE IF EXISTS SPACEXTABLE;</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream">Environment variable $DATABASE_URL not set, and no connect string given.
Connection info needed in SQLAlchemy format, example:
               postgresql://username:password@hostname/dbname
               or an existing connection: dict_keys([])
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [8]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>%sql create table SPACEXTABLE as select * from SPACEXTBL where Date is not null</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream">Environment variable $DATABASE_URL not set, and no connect string given.
Connection info needed in SQLAlchemy format, example:
               postgresql://username:password@hostname/dbname
               or an existing connection: dict_keys([])
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h2>Tasks</h2><br><br>Now write and execute SQL queries to solve the assignment tasks.<br><br><em></em>Note: If the column names are in mixed case enclose it in double quotes<br>   For Example "Landing_Outcome"<em></em><br><br><h3>Task 1</h3><br><br><br><br><br>##### Display the names of the unique launch sites  in the space mission<br></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [12]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>df.head(5)</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt">Out[12]:</div>
                        <div class="output-content">
                            <div class="output-html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Time (UTC)</th>
      <th>Booster_Version</th>
      <th>Launch_Site</th>
      <th>Payload</th>
      <th>PAYLOAD_MASS__KG_</th>
      <th>Orbit</th>
      <th>Customer</th>
      <th>Mission_Outcome</th>
      <th>Landing_Outcome</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2010-06-04</td>
      <td>18:45:00</td>
      <td>F9 v1.0  B0003</td>
      <td>CCAFS LC-40</td>
      <td>Dragon Spacecraft Qualification Unit</td>
      <td>0</td>
      <td>LEO</td>
      <td>SpaceX</td>
      <td>Success</td>
      <td>Failure (parachute)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2010-12-08</td>
      <td>15:43:00</td>
      <td>F9 v1.0  B0004</td>
      <td>CCAFS LC-40</td>
      <td>Dragon demo flight C1, two CubeSats, barrel of...</td>
      <td>0</td>
      <td>LEO (ISS)</td>
      <td>NASA (COTS) NRO</td>
      <td>Success</td>
      <td>Failure (parachute)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2012-05-22</td>
      <td>7:44:00</td>
      <td>F9 v1.0  B0005</td>
      <td>CCAFS LC-40</td>
      <td>Dragon demo flight C2</td>
      <td>525</td>
      <td>LEO (ISS)</td>
      <td>NASA (COTS)</td>
      <td>Success</td>
      <td>No attempt</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2012-10-08</td>
      <td>0:35:00</td>
      <td>F9 v1.0  B0006</td>
      <td>CCAFS LC-40</td>
      <td>SpaceX CRS-1</td>
      <td>500</td>
      <td>LEO (ISS)</td>
      <td>NASA (CRS)</td>
      <td>Success</td>
      <td>No attempt</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2013-03-01</td>
      <td>15:10:00</td>
      <td>F9 v1.0  B0007</td>
      <td>CCAFS LC-40</td>
      <td>SpaceX CRS-2</td>
      <td>677</td>
      <td>LEO (ISS)</td>
      <td>NASA (CRS)</td>
      <td>Success</td>
      <td>No attempt</td>
    </tr>
  </tbody>
</table>
</div></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [20]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>pd.read_sql_query("""
SELECT DISTINCT Launch_Site
FROM SPACEXTBL
""", con)</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt">Out[20]:</div>
                        <div class="output-content">
                            <div class="output-html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Launch_Site</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>CCAFS LC-40</td>
    </tr>
    <tr>
      <th>1</th>
      <td>VAFB SLC-4E</td>
    </tr>
    <tr>
      <th>2</th>
      <td>KSC LC-39A</td>
    </tr>
    <tr>
      <th>3</th>
      <td>CCAFS SLC-40</td>
    </tr>
  </tbody>
</table>
</div></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><br><h3>Task 2</h3><br><br><br>#####  Display 5 records where launch sites begin with the string 'CCA' <br></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [23]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>pd.read_sql_query("""
SELECT LAUNCH_SITE
FROM SPACEXTBL WHERE Launch_Site LIKE "CCA%"
LIMIT 5
""", con)</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt">Out[23]:</div>
                        <div class="output-content">
                            <div class="output-html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Launch_Site</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>CCAFS LC-40</td>
    </tr>
    <tr>
      <th>1</th>
      <td>CCAFS LC-40</td>
    </tr>
    <tr>
      <th>2</th>
      <td>CCAFS LC-40</td>
    </tr>
    <tr>
      <th>3</th>
      <td>CCAFS LC-40</td>
    </tr>
    <tr>
      <th>4</th>
      <td>CCAFS LC-40</td>
    </tr>
  </tbody>
</table>
</div></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Task 3</h3><br>##### Display the total payload mass carried by boosters launched by NASA (CRS)</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [26]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>pd.read_sql_query("""
SELECT SUM(PAYLOAD_MASS__KG_) AS total_payload_mass_kg
FROM SPACEXTBL
WHERE Customer = 'NASA (CRS)'
""", con)
</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt">Out[26]:</div>
                        <div class="output-content">
                            <div class="output-html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_payload_mass_kg</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>45596</td>
    </tr>
  </tbody>
</table>
</div></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Task 4</h3><br><br><br><br><br>##### Display average payload mass carried by booster version F9 v1.1<br></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [29]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>pd.read_sql_query("""
SELECT AVG(PAYLOAD_MASS__KG_) AS total_payload_mass_kg
FROM SPACEXTBL
WHERE Booster_Version = 'F9 v1.1'
""", con)</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt">Out[29]:</div>
                        <div class="output-content">
                            <div class="output-html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_payload_mass_kg</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2928.4</td>
    </tr>
  </tbody>
</table>
</div></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Task 5</h3><br><br>##### List the date when the first succesful landing outcome in ground pad was acheived.<br><br>_Hint:Use min function_ <br></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [30]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>pd.read_sql_query("""
SELECT MIN(Date) AS first_successful_ground_pad
FROM SPACEXTBL
WHERE Landing_Outcome LIKE 'Success%Ground Pad%'
""", con)
</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt">Out[30]:</div>
                        <div class="output-content">
                            <div class="output-html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>first_successful_ground_pad</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2015-12-22</td>
    </tr>
  </tbody>
</table>
</div></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Task 6</h3><br><br>##### List the names of the boosters which have success in drone ship and have payload mass greater than 4000 but less than 6000<br></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [33]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>pd.read_sql_query("""
SELECT DISTINCT Booster_Version
FROM SPACEXTBL
WHERE Landing_Outcome LIKE 'Success%Drone Ship%'
  AND PAYLOAD_MASS__KG_ &gt; 4000
  AND PAYLOAD_MASS__KG_ &lt; 6000
""", con)
</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt">Out[33]:</div>
                        <div class="output-content">
                            <div class="output-html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Booster_Version</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>F9 FT B1022</td>
    </tr>
    <tr>
      <th>1</th>
      <td>F9 FT B1026</td>
    </tr>
    <tr>
      <th>2</th>
      <td>F9 FT  B1021.2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>F9 FT  B1031.2</td>
    </tr>
  </tbody>
</table>
</div></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Task 7</h3><br>##### List the total number of successful and failure mission outcomes</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [34]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>pd.read_sql_query("""
SELECT Mission_Outcome, COUNT(*) AS total
FROM SPACEXTBL
GROUP BY Mission_Outcome
""", con)</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt">Out[34]:</div>
                        <div class="output-content">
                            <div class="output-html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Mission_Outcome</th>
      <th>total</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Failure (in flight)</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Success</td>
      <td>98</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Success</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Success (payload status unclear)</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Task 8</h3><br>##### List all the booster_versions that have carried the maximum payload mass, using a subquery with a suitable aggregate function.</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [35]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>pd.read_sql_query("""
SELECT DISTINCT Booster_Version
FROM SPACEXTBL
WHERE PAYLOAD_MASS__KG_ = (
    SELECT MAX(PAYLOAD_MASS__KG_)
    FROM SPACEXTBL
)
""", con)
</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt">Out[35]:</div>
                        <div class="output-content">
                            <div class="output-html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Booster_Version</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>F9 B5 B1048.4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>F9 B5 B1049.4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>F9 B5 B1051.3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>F9 B5 B1056.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>F9 B5 B1048.5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>F9 B5 B1051.4</td>
    </tr>
    <tr>
      <th>6</th>
      <td>F9 B5 B1049.5</td>
    </tr>
    <tr>
      <th>7</th>
      <td>F9 B5 B1060.2</td>
    </tr>
    <tr>
      <th>8</th>
      <td>F9 B5 B1058.3</td>
    </tr>
    <tr>
      <th>9</th>
      <td>F9 B5 B1051.6</td>
    </tr>
    <tr>
      <th>10</th>
      <td>F9 B5 B1060.3</td>
    </tr>
    <tr>
      <th>11</th>
      <td>F9 B5 B1049.7</td>
    </tr>
  </tbody>
</table>
</div></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Task 9</h3><br>##### List the records which will display the month names, failure landing_outcomes in drone ship ,booster versions, launch_site for the months in year 2015.<br><strong>Note: SQLLite does not support monthnames. So you need to use  substr(Date, 6,2) as month to get the months and substr(Date,0,5)='2015' for year.</strong></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [36]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>pd.read_sql_query("""
SELECT 
    substr(Date,6,2) AS month,
    Landing_Outcome,
    Booster_Version,
    Launch_Site
FROM SPACEXTBL
WHERE substr(Date,0,5) = '2015'
  AND Landing_Outcome LIKE 'Failure%Drone Ship%'
""", con)
</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt">Out[36]:</div>
                        <div class="output-content">
                            <div class="output-html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>month</th>
      <th>Landing_Outcome</th>
      <th>Booster_Version</th>
      <th>Launch_Site</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>01</td>
      <td>Failure (drone ship)</td>
      <td>F9 v1.1 B1012</td>
      <td>CCAFS LC-40</td>
    </tr>
    <tr>
      <th>1</th>
      <td>04</td>
      <td>Failure (drone ship)</td>
      <td>F9 v1.1 B1015</td>
      <td>CCAFS LC-40</td>
    </tr>
  </tbody>
</table>
</div></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Task 10</h3><br>##### Rank the count of landing outcomes (such as Failure (drone ship) or Success (ground pad)) between the date 2010-06-04 and 2017-03-20, in descending order.</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [37]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>pd.read_sql_query("""
SELECT 
    Landing_Outcome,
    COUNT(*) AS total
FROM SPACEXTBL
WHERE Date BETWEEN '2010-06-04' AND '2017-03-20'
GROUP BY Landing_Outcome
ORDER BY total DESC
""", con)</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt">Out[37]:</div>
                        <div class="output-content">
                            <div class="output-html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Landing_Outcome</th>
      <th>total</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>No attempt</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Success (drone ship)</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Failure (drone ship)</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Success (ground pad)</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Controlled (ocean)</td>
      <td>3</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Uncontrolled (ocean)</td>
      <td>2</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Failure (parachute)</td>
      <td>2</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Precluded (drone ship)</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [38]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>con.close()</pre></div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Reference Links</h3><br><br>* <a href ="https://cf-courses-data.s3.us.cloud-object-storage.appdomain.cloud/IBMDeveloperSkillsNetwork-DB0201EN-SkillsNetwork/labs/Labs_Coursera_V5/labs/Lab%20-%20String%20Patterns%20-%20Sorting%20-%20Grouping/instructional-labs.md.html?origin=www.coursera.org">Hands-on Lab : String Patterns, Sorting and Grouping</a>  <br><br>*  <a  href="https://cf-courses-data.s3.us.cloud-object-storage.appdomain.cloud/IBMDeveloperSkillsNetwork-DB0201EN-SkillsNetwork/labs/Labs_Coursera_V5/labs/Lab%20-%20Built-in%20functions%20/Hands-on_Lab__Built-in_Functions.md.html?origin=www.coursera.org">Hands-on Lab: Built-in functions</a><br><br>*  <a  href="https://cf-courses-data.s3.us.cloud-object-storage.appdomain.cloud/IBMDeveloperSkillsNetwork-DB0201EN-SkillsNetwork/labs/Labs_Coursera_V5/labs/Lab%20-%20Sub-queries%20and%20Nested%20SELECTs%20/instructional-labs.md.html?origin=www.coursera.org">Hands-on Lab : Sub-queries and Nested SELECT Statements</a><br><br>*   <a href="https://cf-courses-data.s3.us.cloud-object-storage.appdomain.cloud/IBMDeveloperSkillsNetwork-DB0201EN-SkillsNetwork/labs/Module%205/DB0201EN-Week3-1-3-SQLmagic.ipynb">Hands-on Tutorial: Accessing Databases with SQL magic</a><br><br>*  <a href= "https://cf-courses-data.s3.us.cloud-object-storage.appdomain.cloud/IBMDeveloperSkillsNetwork-DB0201EN-SkillsNetwork/labs/Module%205/DB0201EN-Week3-1-4-Analyzing.ipynb">Hands-on Lab: Analyzing a real World Data Set</a><br><br><br></div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h2>Author(s)</h2><br><br><h4> Lakshmi Holla </h4><br></div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h2>Other Contributors</h2><br><br><h4> Rav Ahuja </h4><br></div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><!--<br><h2>Change log</h2><br>| Date | Version | Changed by | Change Description |<br>|------|--------|--------|---------|<br>| 2024-07-10 | 1.1 |Anita Verma | Changed Version|<br>| 2021-07-09 | 0.2 |Lakshmi Holla | Changes made in magic sql|<br>| 2021-05-20 | 0.1 |Lakshmi Holla | Created Initial Version |<br>--><br></div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h2><h3 align="center"> © IBM Corporation 2021. All rights reserved. <h3/></h2><br></div>
            </div>
        </div>
    </div>
    <footer class="export-footer">
        Exported with <a href="https://www.runcell.dev/tool/ipynb-to-html">runcell</a> — convert notebooks to HTML or PDF anytime at runcell.dev.
    </footer>
</body>
</html>